<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lgy.project_book_store.dao.UserDAO">

  <select id="loginYn" parameterType="hashmap" resultType="string">
        select user_pw from users where user_id=#{user_id}
    </select>
    
    <insert id="register" parameterType="hashmap">
        insert into users(user_id, user_pw, user_email, user_phone_num, user_post_num, user_address, user_detail_address, user_name, user_nickname) 
        values(#{user_id},#{user_pw},#{user_email},#{user_phone_num},#{user_post_num},#{user_address},#{user_detail_address},#{user_name},#{user_nickname})
    </insert>
	
<!-- 	아이디가 있으면 1 -->
    <select id="checkId" parameterType="string" resultType="int">
        select count(*) from users where user_id = #{user_id}
    </select>
    
    <select id="checkEmail" parameterType="String" resultType="int">
    	select count(*) from users where user_email = #{user_email}
	</select>
    
    <select id="findIdByEmail" parameterType="String" resultType="String">
        select user_id from users where user_email = #{user_email}
    </select>
 

  <!-- 마이페이지: 단건 조회 -->
  <select id="selectUser" parameterType="hashmap" resultType="hashmap">
  SELECT
      user_id            AS "user_id",
      user_name          AS "user_name",
      user_nickname      AS "user_nickname",
      user_email         AS "user_email",
      user_phone_num     AS "user_phone_num",
      user_post_num      AS "user_post_num",
      user_address       AS "user_address",
      user_detail_address AS "user_detail_address",
      TO_CHAR(reg_date, 'YYYY-MM-DD') AS "reg_date",
      TO_CHAR(last_login_date, 'YYYY-MM-DD') AS "last_login_date"
  FROM users
  WHERE user_id = #{user_id, jdbcType=VARCHAR}
</select>


  <!-- 마이페이지: 정보 수정 (비밀번호 제외) -->
  <update id="updateUser" parameterType="hashmap">
    UPDATE users
       SET user_name            = #{user_name, jdbcType=VARCHAR},
           user_nickname        = #{user_nickname, jdbcType=VARCHAR},
           user_email           = #{user_email, jdbcType=VARCHAR},
           user_phone_num       = #{user_phone_num, jdbcType=VARCHAR},
           user_post_num        = #{user_post_num, jdbcType=VARCHAR},
           user_address         = #{user_address, jdbcType=VARCHAR},
           user_detail_address  = #{user_detail_address, jdbcType=VARCHAR}
     WHERE user_id = #{user_id, jdbcType=VARCHAR}
</update>

<delete id="withdraw" parameterType="hashmap">
  DELETE FROM users
  WHERE user_id = #{user_id, jdbcType=VARCHAR}
    AND user_pw = #{user_pw, jdbcType=VARCHAR}
</delete>

  

</mapper>
